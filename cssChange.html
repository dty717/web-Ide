<!DOCTYPE html>
<!--现在采用9位类id ,一个节点只能含有9个子节点-->   
<html>		
			
	<head>	
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			div {
				border: dashed;
				padding: 30px;
			}
			
			.hide {
				display: none
			}
			
			p {
				border: dotted;
			}
		</style>
		<style type="text/css">
			
			
		</style>
	</head>	
				
	<body>		
		<div id="i1" class="c1">
			i1
			
			<div id="i2">
				i2
				<div id="i3">
					i3
				</div>
			</div>
			<div id="i4" class="c11 c1">
				i4
				<div id="i5">
					i5	
				</div>
			</div>
			<div id="i6" class="c12 c1">
				i6;
				<div id="i7" class="c12">
					i7
					<div id="i8">
						
						<div id="i9">
							
						</div>
					</div>
					<div id="i10">
						
					</div>
				</div>
			</div>
		</div>
		<div id="i11" class="c2">
			5
		</div>
		<hideid class="hide">11</hideid>
		<hideclass class="hide">4</hideclass>
	</body>			
		<script type="text/javascript">
			//事件触发器
			var occur=0;
			
			
			//计算子节点
			function countchildren(obj){
				var count=0;
				function countchild(obj){
					var children=obj.children;
					for (var i = 0; i < children.length; i++) {
						count++;
						countchild(children[i]);
					}
				} 
				countchild(obj);
				var a =count;
				count=0
				return a;
			}		   
			//测试项
			var aa=document.getElementById("i1")
//			alert(countchildren(aa));
				   
				
		//	
		 	
			
//之后插入 --脚本之家http://www.jb51.net/article/35412.htm|||原生js实现给指定元素的后面追加内容
		function insertAfter( newElement, targetElement ){
			var parent = targetElement.parentNode; 
			if( parent.lastChild == targetElement ){
				parent.appendChild( newElement, targetElement ); 
			}else{ 
				parent.insertBefore( newElement, targetElement.nextSibling ); 
				}; 
		}	



		
		
		
		
		//增加元素节点
			//增加子元素：取第一个
			function addchild(obj){
				var get=prompt("输入元素_内容","div_").split("_")
				var point = document.createElement(get[0]);
				point.innerText = get[1];
				var changeid=parseInt(obj.id.substring(1))+1+countchildren(obj);
				corchangeid(changeid);
				point.id = "i"+changeid;
				obj.appendChild(point);
				point.onclick = function() {
					if(changeflag == 1) {
					change(this)
					}
				}
			}
			function content(obj){
				var get=prompt("内容",obj.innerHTML);
				obj.innerHTML=get;
			}
			function addcontent(obj){
				var get=prompt("内容","");
				obj.innerHTML+=get;
			}
			
			
			
			//增加同类节点-或者外层节点
			//之后加入元素
			function addouter(obj) {
				var get=prompt("输入元素_内容","div_").split("_")
				
				var point = document.createElement(get[0]);
				point.innerText = get[1];	
				var changeid=parseInt(obj.id.substring(1))+1+countchildren(obj);
				corchangeid(changeid);
				point.id = "i"+changeid;
				insertAfter(point,obj); 
				point.onclick = function() {
					if(changeflag == 1) {
					change(this)
					}
				}
			}
			//之前加入元素
			function addouterbefore(obj) {
				var get=prompt("输入元素_内容","div_").split("_")
				var point = document.createElement(get[0]);
				point.innerText = get[1];	
				var changeid=parseInt(obj.id.substring(1));				
				corchangeid(changeid)
				point.id = "i"+changeid; 
				obj.parentNode.insertBefore(point, obj);
				point.onclick = function() {
					if(changeflag == 1) {
					change(this)
					}
				}
			}	
				
			//所有节点加一 
			function corchangeid(num) {
				var idnum = document.getElementsByClassName("hide")[0];
				var classnum = document.getElementsByClassName("hide")[1];
				
				var inum = parseInt(idnum.innerHTML);
				idnum.innerHTML=inum+1;
				for (var i =inum; i >= num; i--) {
					var point=document.getElementById("i"+i)
					point.id="i"+(i+1)					
				}
			}	
			//所有同类节点改变class值
			 	
			
			
			
			
			
			
			
			
			
			var ap=document.getElementById("i1");
			var ach=ap.children;
			for (var i = 0; i < ach.length; i++) {
//				alert(ach[i].innerHTML)
			}	
//			alert(ach[0].innerHTML)
	
				
			//增加非同类节点-或者内层节点
			//	
				
			//增加节点  兄弟节点
//			function add(obj) {
//				var add = document.createElement("div")
//				add.innerHTML = "掌声在哪里"
//				var i3 = document.getElementById("i2")
//				var i2 = document.getElementById("i3")
//				var i1 = document.getElementById("i1")
//				
//				i1.insertBefore(add, i3);
//			}	
//			add()
				
			//删减节点
			function deleted(obj){
				var iod=parseInt(obj.id.substring(1));
				var icd=countchildren(obj)+1;
//				obj.innerHTML="";
				obj.parentNode.removeChild(obj);
				corchangeidbydel(iod,icd);
			}
			function corchangeidbydel(num,y) {
				var idnum = document.getElementsByClassName("hide")[0];
				var classnum = document.getElementsByClassName("hide")[1];
				
				var inum = parseInt(idnum.innerHTML);
				idnum.innerHTML=inum-y;  
				for (var i =inum; i >= num+y; i--) {
					var point=document.getElementById("i"+i);
					point.id="i"+(i-y);					
				}
			}
			
			var a=document.getElementById("i2");
//		 	alert(a.parentNode.innerHTML)
//			a.parentNode.removeChild(a);
			
			
			 
			
			
			//改变样式的函数
				
			function change(obj) {
				var styl = document.getElementsByTagName("style")[0];
				var styl1=document.getElementsByTagName("style")[1];
				styl1.innerHTML="#"+obj.id+"{border:dotted}"

				var changecss = prompt("改变样式~~" + obj.id, "");
				styl1.innerHTML="";
				if(changecss=="addtext")
				  {changeflag = 0;
				  addcontent(obj);
				  return;}
				  if(changecss=="txt")
				  {changeflag = 0;
				  content(obj);
				  return;}
				if(changecss=="add")
				  {changeflag = 0;
				  addouter(obj);
				  return;}
				if(changecss=="addbefore")
				  {changeflag = 0;
				  addouterbefore(obj);
				  return;}
				if(changecss=="del")
				  {changeflag = 0;
				  deleted(obj);
				  return;}
				  if(changecss=="addc")
				  {changeflag = 0;
				  addchild(obj);
				  return;}
				//console.debug(obj.id)
				if(changecss == null)
					return;
				if(changecss != "")
					styl.innerHTML += "#" + obj.id + "{" + changecss + "}";
				changeflag = 0;
			}	
		
					var hide=document.getElementsByClassName("hide")[0];
				
					var tot=parseInt(hide.innerHTML);
	
			var changeflag = 1;
			var body = document.getElementsByTagName("body")[0]
			body.onclick = function() {
				if(changeflag == 1) {
					console.debug(null);
			} else {
					changeflag = 1;

				}

			}
			
			for(var i = 1; i <= tot; i++) {
				var str = "i" + i;
				var id = document.getElementById(str);
				id.onclick = function() {
					if(changeflag == 1) {
						change(this)
					}
				}
			
			}
		</script>
			
			
			
</html>		